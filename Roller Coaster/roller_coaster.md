# Roller coaster
Прочитав описание и условие [задачи](https://www.codingame.com/training/hard/roller-coaster), показалось, что она довольно легкая, ведь все цикличные вычисления можно свести к простой формуле.
Однако прокрутив несколько примеров в голове, стало ясно, что сложной задачей тут является не само прогнозирование доходов, а определение начала наступления устоявшегося цикла.

## [Решение](roller_coaster.cpp)
- Первым делом сделал решение "в лоб", просто увеличивая счетчик дохода, что уже выполняло несколько тестов, но, очевидно, упиралось во время выполения;

- Потом определил крайний случай, когда количество людей меньше вместимости аттракциона и все люди влезают разом;
Когда замечен такой случай, ответ рассчитывается по простой [формуле](roller_coaster.cpp#L100). Это позволило выполнить еще один тест.

Далее без определения цикла выполнение остальных тестов было невозможным. Определять появление цикла решил с помощью hash-таблицы, сравнивая ее предыдущий и текущий размер. В таблице хранил [счетчик поездок](roller_coaster.cpp#L38) для каждой уникальной группы, которая попадала на аттракцион. 

Когда размер таблицы перестает расти, считается, что [обнаружился цикл](roller_coaster.cpp#L123), после этого происходит симуляция поездок в количестве равной рамеру таблицы для дальнейшего определения групп, которые попадают в цикл. Для исключения ложных срабатываний алгоритм должен просимулировать полностью один цикл всей изначальной группы (в этой задаче это сработало).

После обнаружения цикла и выполнения остальных условий итоговый доход расчитывается по [формуле](roller_coaster.cpp#L66).

## Сложности
Самым сложным для меня оказалось найти способ определения цикличности.

## Возможные улучшения
Мне кажется, что есть способ определить цикличные группы без повторного прохождения образовавшегося цикла.

Исключение ложного определение цикла методом симуляции всего цикла изначальной группы, как мне кажется, не всегда сработает и по-хорошему, сделать что-то более однозначное.

## Автотесты
Я сделал автотесты для этой задачки, так как у нее нет сложной симуляции и ответ в виде одной цифры. Сделал с целью продемонстрировать, что в какой-то степени с cmake я работать умею.

Для сборки запускать команду: *cmake build .. -DBUILD_TESTS=ON*, иначе тесты не соберутся. Тесты запускать с помощью ctest. Тестировал с gcc.